{% extends "base.html" %}

{% block content %}
<div class="text-center space-y-8 animate-fade-in-up">

    <div
        class="glass p-12 rounded-3xl max-w-2xl mx-auto border border-blue-500/30 shadow-[0_0_50px_rgba(59,130,246,0.2)]">

        <div class="mb-8 flex justify-center">
            <div class="animate-spin rounded-full h-24 w-24 border-t-2 border-b-2 border-blue-400"></div>
        </div>

        <h1 class="text-4xl font-bold mb-4">Cooking Up Your Video! ğŸ³</h1>
        <p class="text-xl text-gray-300 mb-8">
            Our AI agents are writing the script, generating images, and composing music.<br>
            This usually takes <strong>1-2 minutes</strong>.
        </p>

        <div class="bg-gray-800/50 rounded-xl p-6 text-left space-y-3 mb-8 text-sm text-gray-400" id="status-box">
            <p>âœ… Topic Received</p>
            <p>ğŸ”„ Generating Script (Gemini)...</p>
            <p>ğŸ”„ Synthesizing Voice (ElevenLabs)...</p>
            <p>ğŸ”„ Creating Visuals (Pollinations)...</p>
            <p>ğŸ”„ Composing Music...</p>
        </div>

        <a href="/gallery"
            class="inline-block bg-blue-600 hover:bg-blue-500 text-white font-bold py-3 px-8 rounded-full transition transform hover:scale-105">
            Check Gallery for Result
        </a>

        <p class="mt-4 text-xs text-gray-500">ID: {{ myid }}</p>
    </div>

</div>

<script>
    const checkStatus = () => {
        const videoId = "{{ myid }}";
        fetch(`/status/${videoId}`)
            .then(response => response.json())
            .then(data => {
                if (data.status === 'done') {
                    window.location.href = "/gallery";
                }
            })
            .catch(err => console.error(err));
    }

    // Check every 3 seconds
    setInterval(checkStatus, 3000);
</script>
{% endblock %}